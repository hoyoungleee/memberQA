<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.mapper.BoardMapper">



<!-- ListSelect -->


<!--    <select id="getLists"
      parameterType="com.example.demo.vo.BoardVO"
      resultType="com.example.demo.vo.BoardVO">
      SELECT *
      FROM HJ_BOARD JOIN USER ON HJ_BOARD.USER =
      USER.user;
   </select>  -->

<!-- 검색 LIST 쿼리 -->

   <select id="getLists"
      parameterType="com.example.demo.vo.BoardVO" resultType="com.example.demo.vo.BoardVO">
      SELECT *
      FROM HJ_BOARD JOIN USER ON HJ_BOARD.USER = USER.user
      <if test="search != null">
      WHERE 1 = 1
         AND HJ_BOARD.TITLE LIKE CONCAT('%', #{search}, '%')
      </if>
       order by HJ_BOARD.REG_DT desc
      <if test="page != null">
     LIMIT #{page}, 10
      </if>
     
   </select>
   
   
   
   <select id="count" resultType="int" parameterType="com.example.demo.vo.BoardVO">
 SELECT COUNT(HJ_BOARD.P_ID) as CNT
      FROM HJ_BOARD JOIN USER ON HJ_BOARD.USER = USER.user
       <if test="search != null">
      WHERE 1 = 1
         AND HJ_BOARD.TITLE LIKE CONCAT('%', #{search}, '%')
      </if>
       order by HJ_BOARD.REG_DT desc
   </select>

   <!-- insert -->
   <insert id="insert" parameterType="com.example.demo.vo.BoardVO">
      INSERT INTO HJ_BOARD (TITLE,
      DESCRIPTION, REG_DT, TEXT_OPEN, ANSWER,
      ADMIN_ANSWER, user)
      VALUES
      (#{title},#{description},now(),'Y', #{answer},'N', 'c')
   </insert>

   <!-- delete -->
   <delete id="delete" parameterType="com.example.demo.vo.BoardVO">
      DELETE FROM HJ_BOARD
      WHERE P_ID
      = #{p_id}
   </delete>

   <!-- update -->
   <update id="update" parameterType="com.example.demo.vo.BoardVO">
      update hj_board set TITLE =
      #{title}, DESCRIPTION = #{description},
      REG_DT = now(), ANSWER =
      #{answer},
      ADMIN_ANSWER = #{admin_answer}
      where P_ID = #{p_id}
   </update>

   <!-- ViewSelect -->
   <select id="view" parameterType="String"
      resultType="com.example.demo.vo.BoardVO">
      select
      HJ_BOARD.TITLE,
      HJ_BOARD.DESCRIPTION,
      HJ_BOARD.REG_DT,
      HJ_BOARD.TEXT_OPEN,
      HJ_BOARD.ANSWER,
      HJ_BOARD.ADMIN_ANSWER,
      HJ_BOARD.P_ID,
      user.user,
      user.lv
      from hj_board JOIN USER ON HJ_BOARD.USER = USER.user where P_ID = #{p_id}
   </select>



</mapper>